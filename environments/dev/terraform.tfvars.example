# Development Environment Configuration
# This file is used for both manual deployments and CI/CD via GitHub Actions

# General Settings
aws_region   = "us-east-1"
name_prefix  = "litellm-dev-ci"  # CI deployments use dev-ci prefix for isolation

# Default tags for all resources
default_tags = {
  Environment = "dev"
  Project     = "litellm"
  ManagedBy   = "terraform-ci"  # Indicates CI/CD managed resources
  Owner       = "github-actions"
  CostCenter  = "engineering"
}

# VPC Configuration
vpc_cidr                 = "10.0.0.0/16"
public_subnet_cidrs      = ["10.0.1.0/24", "10.0.2.0/24"]
private_subnet_cidrs     = ["10.0.10.0/24", "10.0.20.0/24"]
database_subnet_cidrs    = ["10.0.100.0/24", "10.0.200.0/24"]
enable_nat_gateway       = true
single_nat_gateway       = true  # Cost optimization for dev

# Security Configuration  
allowed_cidr_blocks = ["68.76.147.104/32"]  # Restrict to your IP only

# LiteLLM Configuration
litellm_port    = 4000
container_image = "PLACEHOLDER_REPLACED_BY_GITHUB_ACTIONS"  # Dynamically set by CI/CD workflow

# Database Configuration
database_name     = "litellm"
database_username = "litellm"
# Database password is auto-generated
db_engine_version          = "15.8"
db_instance_class          = "db.t3.micro"
db_allocated_storage       = 20
db_max_allocated_storage   = 100
db_storage_encrypted       = true
db_backup_retention_period = 7
db_multi_az               = false  # Single AZ for dev
db_deletion_protection    = false  # Allow deletion in dev
db_skip_final_snapshot    = true   # Skip snapshot for dev

# ECS Configuration
ecs_cpu                   = 1024  # Increased for stable LiteLLM operation
ecs_memory               = 2048   # Increased to prevent resource constraints
ecs_desired_count        = 1
ecs_min_capacity         = 1
ecs_max_capacity         = 3
ecs_enable_autoscaling   = false  # Disable autoscaling for dev
ecs_enable_execute_command = true # Enable for debugging

# ALB Configuration
health_check_path                = "/health/readiness"
health_check_interval           = 30
health_check_timeout            = 5
health_check_healthy_threshold  = 2
health_check_unhealthy_threshold = 3
alb_enable_deletion_protection  = false
alb_idle_timeout               = 60

# Additional Environment Variables for LiteLLM
environment_variables = {
  LITELLM_LOG_LEVEL = "DEBUG"
  LITELLM_DROP_PARAMS = "true"
}

# API Keys for LiteLLM Models
# Note: For CI/CD deployments, these values are automatically replaced with GitHub secrets
additional_ssm_parameters = {
  # Required: OpenAI API key for cloud models
  "openai-api-key" = {
    value       = "PLACEHOLDER_REPLACED_BY_GITHUB_ACTIONS"  # Replaced with secrets.OPENAI_API_KEY
    type        = "SecureString"
    description = "OpenAI API Key for LiteLLM Dev"
  }
  
  # Optional: Uncomment additional providers as needed
  # "anthropic-api-key" = {
  #   value       = "sk-ant-your-anthropic-api-key-here"
  #   type        = "SecureString"
  #   description = "Anthropic API Key for Claude models"
  # }
  # 
  # "azure-api-key" = {
  #   value       = "your-azure-openai-key-here"
  #   type        = "SecureString"
  #   description = "Azure OpenAI API Key"
  # }
  # 
  # "azure-api-base" = {
  #   value       = "https://your-resource.openai.azure.com/"
  #   type        = "String"
  #   description = "Azure OpenAI API Base URL"
  # }
  # 
  # "google-api-key" = {
  #   value       = "your-google-api-key-here"
  #   type        = "SecureString"
  #   description = "Google API Key for Gemini models"
  # }
}
